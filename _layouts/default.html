<!DOCTYPE html>

{% comment %}
Get assets path
{% endcomment %}
{% if site.main_github_io %}
  {% assign assets = "/assets" %}
{% else %}
  {% assign assets = "assets" %}
{% endif %}

<html lang="{{ site.lang | default: "en-US" }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    {% if page.img_url %}
    <meta property="og:image" content="{{ page.img_url }}"/>
    {% else %}
    <meta property="og:image" content="{{ assets }}/img/blog_og_image.png"/>
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="628" />
    {% endif %}
    {% unless site.main_github_io %}
    <base href="{{ site.url }}">
    {% endunless %}
    <link rel="stylesheet" type="text/css" href="{{ assets }}/css/{{ site.syntax_highlight_stylesheet }}">
    <link rel="stylesheet" type="text/css" href="{{ assets }}/css/main.css">
    <link rel="alternate" type="application/rss+xml" title="RSS Feed" href="atom.xml" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script>
    <script src="https://threejs.org/build/three.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/simplex-noise/2.4.0/simplex-noise.min.js"></script>
    <script>
      function show_tag_section(tag) {
        // Hide all other tag divs
        document.getElementById('all_posts').style.display = 'none';
        var tag_divs = document.getElementsByClassName('by_tag');
        var i;
        for (var i = 0; i < tag_divs.length; i++) {
          tag_divs[i].style.display = 'none';
        }
        // Show the one we want
        document.getElementById(tag).style.display = 'block';
      }
    </script>
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico">
    {% seo %}
  </head>
  <body onload="show_tag_section('all_posts')">
    <canvas id="threeCanvas" style="position: fixed; top: 0; left: 0; z-index: -1;"></canvas>  <!-- Three.jsのためのcanvas要素を背景に設定 -->
    <div class="header">

      <!-- Large header banner on left for large display widths -->
      <div class="big_header">

        <!-- Name -->
        <div class="name_group">
          <h1>{{ site.name }}</h1>
        </div>

        <a href=""><img src="{{ site.logo }}" alt="Logo" class="center_img" ></a>

        <!-- Position + company -->
        <div class="link_group">

          <div class="row">
              <div class="col1">
                <span> {{ site.position }} at </span>
              </div>
          </div>

          <div class="row">
            <a href="{{ site.company_url }}">
              <div class="col1">
                <img src="{{ assets }}/img/company_icon.png" height="16" width="16">
                <span> {{ site.company_name }} </span>
              </div>
            </a>
          </div>

          <div class="row">
            <div class="col1">
              <img src="{{ assets }}/img/place_icon_dark.png" height="16" width="16">
              <span> {{ site.place_name }} </span>
            </div>
          </div>

        </div>

        <!-- Badges/links -->
        <div class="link_group">

          <div class="row">
            <a href="{{ site.github_url }}">
              <div class="col2">
                <img src="{{ assets }}/img/github_icon_dark.png" height="16" width="16">
                <span> Github </span>
                <div class="block-veil"></div>
              </div>
            </a>
            <!-- <a href="{{ site.linkedin_url }}">
              <div class="col2">
                <img src="{{ assets }}/img/linkedin_icon_dark.png" height="16" width="16">
                <span> LinkedIn </span>
                <div class="block-veil"></div>
              </div>
            </a> -->
          </div>

          <div class="row">
            <a href="mailto:{{ site.email }}">
              <div class="col2">
                <img src="{{ assets }}/img/email_icon_dark.png" height="16" width="16">
                <span> Email </span>
                <div class="block-veil"></div>
              </div>
            </a>
            <!-- <a href="{{ site.resume_url }}">
              <div class="col2">
                <img src="{{ assets }}/img/cv_icon_dark.png" height="16" width="16">
                <span> Resume </span>
                <div class="block-veil"></div>
              </div>
            </a> -->
          </div>

        </div>

      </div>

      <!-- Smaller header banner on top for small display widths -->
      <div class="small_header">

        <!-- Name -->
        <div class="small_header_box">
          <div class="name_header_box">
            <div class="name_header_img">
              <a href="">
                <img src="{{ site.logo }}" alt="Logo" height="60">
              </a>
            </div>
            <div class="name_header_name">
              <h1>{{ site.name }}</h1>
            </div>
          </div>
        </div>

        <!-- Position + Company -->
        <div class="small_header_box">
          <div class="row">
            <div class="col1">
              <span> {{ site.position }} at </span>
            </div>
          </div>
          <div class="row">
            <div class="col1">
              <a href="{{ site.company_url }}">
                <img src="{{ assets }}/img/company_icon.png" height="16" width="16">
                <span> {{ site.company_name }} </span>
              </a>
            </div>
          </div>
        </div>

        <!-- Badges/links -->
        <div class="small_header_box">
            <div class="row">
              <a href="{{ site.github_url }}">
                <div class="col2">
                  <img src="{{ assets }}/img/github_icon_dark.png" height="16" width="16">
                  <span> Github </span>
                  <div class="block-veil"></div>
                </div>
              </a>
              <!-- <a href="{{ site.linkedin_url }}">
                <div class="col2">
                  <img src="{{ assets }}/img/linkedin_icon_dark.png" height="16" width="16">
                  <span> LinkedIn </span>
                  <div class="block-veil"></div>
                </div>
              </a> -->
            </div>

            <div class="row">
              <a href="mailto:{{ site.email }}">
                <div class="col2">
                  <img src="{{ assets }}/img/email_icon_dark.png" height="16" width="16">
                  <span> Email </span>
                  <div class="block-veil"></div>
                </div>
              </a>
              <!-- <a href="{{ site.resume_url }}">
                <div class="col2">
                  <img src="{{ assets }}/img/cv_icon_dark.png" height="16" width="16">
                  <span> Resume </span>
                  <div class="block-veil"></div>
                </div>
              </a> -->
            </div>
        </div>

      </div>

    </div>
    
    <!-- Page content -->
    <div class="content">
      {{ content }}
    </div>

    <canvas id="threeCanvas" style="position: fixed; top: 0; left: 0; z-index: -1;"></canvas>

    <script>
      let scene, camera, renderer, material, line, geometry, time = 0;
      const simplex = new SimplexNoise();

      init();
      animate();

      function init() {
          scene = new THREE.Scene();
          camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
          camera.position.z = 50;

          renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true, canvas: document.getElementById('threeCanvas') });
          renderer.setClearColor(0x000000, 0);
          renderer.setSize(window.innerWidth, window.innerHeight);

          const vertices = [];
          const colors = [];
          const segments = 100;
          const size = 50;

          for (let i = 0; i < segments; i++) {
              for (let j = 0; j < segments; j++) {
                  const x = (i / segments - 0.5) * size;
                  const y = (j / segments - 0.5) * size;
                  const z = simplex.noise3D(i / segments, j / segments, time) * 2;

                  vertices.push(x, y, z);
                  colors.push(0, 0, 1, 1 - (i / segments));
              }
          }

          geometry = new THREE.BufferGeometry();
          geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
          geometry.setAttribute('color', new THREE.Float32BufferAttribute(colors, 4));

          const indices = [];

          for (let i = 0; i < segments - 1; i++) {
              for (let j = 0; j < segments - 1; j++) {
                  const index1 = i * segments + j;
                  const index2 = (i + 1) * segments + j;
                  const index3 = (i + 1) * segments + j + 1;
                  const index4 = i * segments + j + 1;

                  indices.push(index1, index2, index2, index3, index3, index4, index4, index1);
              }
          }

          geometry.setIndex(indices);

          material = new THREE.LineBasicMaterial({ vertexColors: true, transparent: true });

          line = new THREE.LineSegments(geometry, material);
          scene.add(line);

          window.addEventListener('resize', () => {
              camera.aspect = window.innerWidth / window.innerHeight;
              camera.updateProjectionMatrix();
              renderer.setSize(window.innerWidth, window.innerHeight);
          });
      }

      function animate() {
          time += 0.01;
          updateVertices();
          requestAnimationFrame(animate);
          renderer.render(scene, camera);
      }

      function updateVertices() {
          const vertices = [];
          const segments = 100;
          const size = 50;

          for (let i = 0; i < segments; i++) {
              for (let j = 0; j < segments; j++) {
                  const x = (i / segments - 0.5) * size;
                  const y = (j / segments - 0.5) * size;
                  const z = simplex.noise3D(i / segments, j / segments, time) * 2;

                  vertices.push(x, y, z);
              }
          }

          geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
          geometry.attributes.position.needsUpdate = true;
      }
    </script>
    <script>
      document.addEventListener("DOMContentLoaded", function() {
        const elements = document.querySelectorAll('.post_block, .conf_block, .contest_block, .experience_block, .profile, .education, .skills, .post_tag, .language-btn, .col2');

        const observer = new IntersectionObserver(function(entries) {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('make-visible');
              entry.target.classList.add('revealed');
              observer.unobserve(entry.target); // 一度表示された要素の監視を停止
            }
          });
        });

        elements.forEach(element => {
          observer.observe(element);
        });
      });
    </script>
  </body>
</html>
